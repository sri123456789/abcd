@Load
Feature: feature collection for the restrictedAreaNotams API on the load-service

  Background: 

  @FDS-167434-2 @FDS-177383
  Scenario: implementation to send request for caution and verify status code/payload
    Given url 'https://ncs-load-ta-wus.azurewebsites.net/v1/runwayConditions'
    And header Non-Human-Id-JWT-TOKEN = 'eyJraWQiOiJUQUdFQWItWXV4emxiV3pGM3g1ZTBQV2ZVZEUiLCJhbGciOiJFUzI1NiJ9.eyJhdWQiOiJOb24tSHVtYW4tSWQtSldUIiwiaWZzIjp7InNwQXR0cnMiOm51bGwsIm1haW51cG4iOm51bGwsIm1haW5vcmdhbml6YXRpb25pZCI6IlRCQyIsImFzc3VyYW5jZXNjb3JlIjpudWxsLCJhc3N1cmFuY2VsZXZlbCI6bnVsbH0sImlzcyI6IlBpbmdBY2Nlc3NBdXRoVG9rZW4iLCJmcCI6eyJzdWJqZWN0IjoiUGVyZlRlc3RYNTA5Q2xpZW50OjpDTj1Cb2VpbmcgQmFzaWMgQXNzdXJhbmNlIFNvZnR3YXJlIElzc3VpbmcgQ0EgRzMsT1U9Y2VydHNlcnZlcnMsTz1Cb2VpbmcsQz1VUzo6ODQ3NDI4ODk0MjA0MzcyOTI5OTk5OTM2NTYxNDg0ODM2NTUwMDgzNzE5NjM2IiwiYXV0aG5Tb3VyY2UiOiJQZXJmVGVzdFg1MDlDbGllbnQifSwiY2VydCI6eyJzdWJzaWRpYXJ5Y29tcGFueUlEIjpudWxsLCJJc3N1ZXIiOiJDTj1Cb2VpbmcgQmFzaWMgQXNzdXJhbmNlIFNvZnR3YXJlIElzc3VpbmcgQ0EgRzMsT1U9Y2VydHNlcnZlcnMsTz1Cb2VpbmcsQz1VUyIsInN1YmplY3QiOiJDTj10ZXN0Y2xpZW50Y2VydC5mZWRwLmRpZ2l0YWxhdmlhdGlvbnNlcnZpY2VzLmNvbSxPVT1zZXJ2ZXJzLE89Qm9laW5nLEM9VVMiLCJzZXJ2aWNlIjpudWxsLCJ1QXR0cmlidXRlcyI6bnVsbCwic3Vic2lkaWFyeUlEIjoiVEJDIiwiYm9laW5nQ29tcGFueUlEIjoiVEJDIiwic2VydmljZUlEIjoiUGVyZlRlc3RYNTA5Q2xpZW50Iiwic2VyaWFsTm8iOiIjODQ3NDI4ODk0MjA0MzcyOTI5OTk5OTM2NTYxNDg0ODM2NTUwMDgzNzE5NjM2In0sImV4cCI6MTYyOTIyNjU3MCwiaWF0IjoxNjI5MjI1Njc1fQ.-8Ucf8ao4Y5j7mmo-OLvVdAKwcwGEEodCpjSqdlv0t935GxNhTbMhml6v2plMRYaGyF-d-MNkXaGbLzZvuzbtg'
    And form field airportId = 'KDTW'
    And form field startDateTime = '2022-01-25T04:31:00Z'
    And form field endDateTime = '2022-07-30T23:59:00Z'
    When method GET
    Then status 200
    And match $ contains [{"type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[-83.3362,42.217197],[-83.337737,42.215111],[-83.33805,42.214685],[-83.339286,42.213007],[-83.340344,42.21157],[-83.341626,42.20983],[-83.342534,42.208597],[-83.343438,42.20737],[-83.344003,42.206604],[-83.344569,42.205834],[-83.34726,42.202181],[-83.347748,42.201519],[-83.347835,42.201401],[-83.348438,42.200583],[-83.349223,42.199517],[-83.349297,42.199416],[-83.349308,42.199401],[-83.349599,42.199006],[-83.34961,42.198992],[-83.349672,42.198906],[-83.35156,42.196343],[-83.352014,42.195727],[-83.352037,42.195696],[-83.351938,42.195656],[-83.351912,42.195646],[-83.351666,42.195545],[-83.351641,42.195535],[-83.351547,42.195497],[-83.351524,42.195527],[-83.34903,42.198913],[-83.348964,42.199002],[-83.348954,42.199017],[-83.348814,42.199207],[-83.348803,42.199222],[-83.348663,42.199411],[-83.348652,42.199426],[-83.348577,42.199528],[-83.347703,42.200715],[-83.347371,42.201165],[-83.347017,42.201645],[-83.346677,42.202107],[-83.341621,42.208971],[-83.341221,42.209513],[-83.337594,42.214437],[-83.337247,42.214909],[-83.335553,42.217208],[-83.335543,42.217221],[-83.335248,42.217622],[-83.33524,42.217633],[-83.334738,42.218314],[-83.334482,42.218662],[-83.333829,42.219548],[-83.33381,42.219574],[-83.333884,42.219604],[-83.33391,42.219615],[-83.334199,42.219734],[-83.334224,42.219745],[-83.3343,42.219776],[-83.334319,42.219751],[-83.334746,42.219171],[-83.334992,42.218837],[-83.335775,42.217773],[-83.335887,42.217622],[-83.335894,42.217612],[-83.33619,42.21721],[-83.3362,42.217197]]]},"properties":{"spat_ref_json":{"spatRef":["RWY-21L-CONC-KDTW-MRHH"]},"lower_alt_msl_ft":0,"upper_alt_msl_ft":99999}}],"notamProperties":{"ntmNumber":"01\/807","fir":{"ntmFir":[{"firId":"KZOB"}]},"ntmEffDate":{"value":"2022-01-22T23:57:00Z","effIndicator":""},"ntmExpDate":{"value":"2026-01-23T23:57:00Z","expIndicator":""},"ntmTxtContent":"\nDTW RWY 21L FICON 10 PCT 1\/8IN DRY SN OBS AT 2201222357.\n2201222357-2201232357\n","runway":{"ntmRwy":[{"rwyId":"21L","rwyAptId":"KDTW","rwyAction":"CAUTION","entityRef":"RWY-21L-CONC-KDTW-MRHH"}]},"ntmJeppStatusDate":"2022-01-23T00:00:51Z","jeppNumber":"20220167B7F"}}], expected: {type=FeatureCollection, features=[{"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[-83.3362,42.217197],[-83.337737,42.215111],[-83.33805,42.214685],[-83.339286,42.213007],[-83.340344,42.21157],[-83.341626,42.20983],[-83.342534,42.208597],[-83.343438,42.20737],[-83.344003,42.206604],[-83.344569,42.205834],[-83.34726,42.202181],[-83.347748,42.201519],[-83.347835,42.201401],[-83.348438,42.200583],[-83.349223,42.199517],[-83.349297,42.199416],[-83.349308,42.199401],[-83.349599,42.199006],[-83.34961,42.198992],[-83.349672,42.198906],[-83.35156,42.196343],[-83.352014,42.195727],[-83.352037,42.195696],[-83.351938,42.195656],[-83.351912,42.195646],[-83.351666,42.195545],[-83.351641,42.195535],[-83.351547,42.195497],[-83.351524,42.195527],[-83.34903,42.198913],[-83.348964,42.199002],[-83.348954,42.199017],[-83.348814,42.199207],[-83.348803,42.199222],[-83.348663,42.199411],[-83.348652,42.199426],[-83.348577,42.199528],[-83.347703,42.200715],[-83.347371,42.201165],[-83.347017,42.201645],[-83.346677,42.202107],[-83.341621,42.208971],[-83.341221,42.209513],[-83.337594,42.214437],[-83.337247,42.214909],[-83.335553,42.217208],[-83.335543,42.217221],[-83.335248,42.217622],[-83.33524,42.217633],[-83.334738,42.218314],[-83.334482,42.218662],[-83.333829,42.219548],[-83.33381,42.219574],[-83.333884,42.219604],[-83.33391,42.219615],[-83.334199,42.219734],[-83.334224,42.219745],[-83.3343,42.219776],[-83.334319,42.219751],[-83.334746,42.219171],[-83.334992,42.218837],[-83.335775,42.217773],[-83.335887,42.217622],[-83.335894,42.217612],[-83.33619,42.21721],[-83.3362,42.217197]]]},"properties":{"spat_ref_json":{"spatRef":["RWY-21L-CONC-KDTW-MRHH"]},"lower_alt_msl_ft":0,"upper_alt_msl_ft":99999}}], notamProperties={ntmNumber=01/807, fir={ntmFir=[{"firId":"KZOB"}]}, ntmEffDate={value=2022-01-22T23:57:00Z, effIndicator=}, ntmExpDate={value=2026-01-23T23:57:00Z, expIndicator=}, ntmTxtContent=DTW RWY 21L FICON 10 PCT 1/8IN DRY SN OBS AT 2201222357.2201222357-2201232357, runway={ntmRwy=[{"rwyId":"21L","rwyAptId":"KDTW","entityRef":"RWY-21L-CONC-KDTW-MRHH"}]}, ntmJeppStatusDate=2022-01-23T00:00:51Z, jeppNumber=20220167B7F}}
  @FDS-167434-3 @FDS-177383
  Scenario: implementation to send request for limited and verify status code/payload
    Given url 'https://ncs-load-ta-wus.azurewebsites.net/v1/runwayConditions'
    And header Non-Human-Id-JWT-TOKEN = 'eyJraWQiOiJUQUdFQWItWXV4emxiV3pGM3g1ZTBQV2ZVZEUiLCJhbGciOiJFUzI1NiJ9.eyJhdWQiOiJOb24tSHVtYW4tSWQtSldUIiwiaWZzIjp7InNwQXR0cnMiOm51bGwsIm1haW51cG4iOm51bGwsIm1haW5vcmdhbml6YXRpb25pZCI6IlRCQyIsImFzc3VyYW5jZXNjb3JlIjpudWxsLCJhc3N1cmFuY2VsZXZlbCI6bnVsbH0sImlzcyI6IlBpbmdBY2Nlc3NBdXRoVG9rZW4iLCJmcCI6eyJzdWJqZWN0IjoiUGVyZlRlc3RYNTA5Q2xpZW50OjpDTj1Cb2VpbmcgQmFzaWMgQXNzdXJhbmNlIFNvZnR3YXJlIElzc3VpbmcgQ0EgRzMsT1U9Y2VydHNlcnZlcnMsTz1Cb2VpbmcsQz1VUzo6ODQ3NDI4ODk0MjA0MzcyOTI5OTk5OTM2NTYxNDg0ODM2NTUwMDgzNzE5NjM2IiwiYXV0aG5Tb3VyY2UiOiJQZXJmVGVzdFg1MDlDbGllbnQifSwiY2VydCI6eyJzdWJzaWRpYXJ5Y29tcGFueUlEIjpudWxsLCJJc3N1ZXIiOiJDTj1Cb2VpbmcgQmFzaWMgQXNzdXJhbmNlIFNvZnR3YXJlIElzc3VpbmcgQ0EgRzMsT1U9Y2VydHNlcnZlcnMsTz1Cb2VpbmcsQz1VUyIsInN1YmplY3QiOiJDTj10ZXN0Y2xpZW50Y2VydC5mZWRwLmRpZ2l0YWxhdmlhdGlvbnNlcnZpY2VzLmNvbSxPVT1zZXJ2ZXJzLE89Qm9laW5nLEM9VVMiLCJzZXJ2aWNlIjpudWxsLCJ1QXR0cmlidXRlcyI6bnVsbCwic3Vic2lkaWFyeUlEIjoiVEJDIiwiYm9laW5nQ29tcGFueUlEIjoiVEJDIiwic2VydmljZUlEIjoiUGVyZlRlc3RYNTA5Q2xpZW50Iiwic2VyaWFsTm8iOiIjODQ3NDI4ODk0MjA0MzcyOTI5OTk5OTM2NTYxNDg0ODM2NTUwMDgzNzE5NjM2In0sImV4cCI6MTYyOTIyNjU3MCwiaWF0IjoxNjI5MjI1Njc1fQ.-8Ucf8ao4Y5j7mmo-OLvVdAKwcwGEEodCpjSqdlv0t935GxNhTbMhml6v2plMRYaGyF-d-MNkXaGbLzZvuzbtg'
    And form field airportId = 'KCVN'
    And form field startDateTime = '2022-02-11T04:31:00Z'
    And form field endDateTime = '2022-07-30T23:59:00Z'
    And form field runwayConditions = 'limited'
    When method GET
    Then status 200
    And match $ contains [{"type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"Point","coordinates":[-103.077581,34.426589]},"properties":{"lower_alt_msl_ft":0,"upper_alt_msl_ft":99999}}],"notamProperties":{"ntmNumber":"08\/013","fir":{"ntmFir":[{"firId":"KZAB"}]},"ntmEffDate":{"value":"2021-08-31T15:10:00Z","effIndicator":""},"ntmExpDate":{"value":"3000-12-31T23:59:59Z","expIndicator":"PERM"},"ntmTxtContent":"\nCVN RWY 12\/30 CHANGED TO 5697FT X 100FT. DECLARED DIST:\nRWY 12 TORA 5697FT TODA 5697FT ASDA 5697FT LDA 5697FT. RWY 30 TORA\n5697FT TODA 5697FT ASDA 5697FT LDA 5697FT. 2108311510-PERM\n","runway":{"ntmRwy":[{"rwyId":"12","rwyAptId":"KCVN","rwyAction":"LIMITED","entityRef":"RWY-12-ASPH-KCVN-MRLL"},{"rwyId":"30","rwyAptId":"KCVN","rwyAction":"LIMITED","entityRef":"RWY-30-ASPH-KCVN-MRLL"}]},"ntmJeppStatusDate":"2021-08-31T15:15:45Z","jeppNumber":"2021085147C"}}], expected: {type=FeatureCollection, features=[{"type":"Feature","geometry":{"type":"Point","coordinates":[-103.077581,34.426589]},"properties":{"lower_alt_msl_ft":0,"upper_alt_msl_ft":99999}}], notamProperties={ntmNumber=08/013, fir={ntmFir=[{"firId":"KZAB"}]}, ntmEffDate={value=2021-08-31T15:10:00Z, effIndicator=}, ntmExpDate={value=3000-12-31T23:59:59Z, expIndicator=PERM}, ntmTxtContent=CVN RWY 12/30 CHANGED TO 5697FT X 100FT. DECLARED DIST:RWY 12 TORA 5697FT TODA 5697FT ASDA 5697FT LDA 5697FT. RWY 30 TORA 5697FT TODA 5697FT ASDA 5697FT LDA 5697FT. 2108311510-PERM, runway={ntmRwy=[{"rwyId":"12","rwyAptId":"KCVN","rwyAction":"LIMITED","entityRef":"RWY-12-ASPH-KCVN-MRLL"},{"rwyId":"30","rwyAptId":"KCVN","rwyAction":"LIMITED","entityRef":"RWY-30-ASPH-KCVN-MRLL"}]}, ntmJeppStatusDate=2021-22-21T15:15:45Z, jeppNumber=2021085147C}}
  @FDS-167434-5 @FDS-177383
  Scenario: implementation to send request for closed runway and verify status code/payload
    Given url 'https://ncs-load-ta-wus.azurewebsites.net/v1/runwayConditions'
    And header Non-Human-Id-JWT-TOKEN = 'eyJraWQiOiJUQUdFQWItWXV4emxiV3pGM3g1ZTBQV2ZVZEUiLCJhbGciOiJFUzI1NiJ9.eyJhdWQiOiJOb24tSHVtYW4tSWQtSldUIiwiaWZzIjp7InNwQXR0cnMiOm51bGwsIm1haW51cG4iOm51bGwsIm1haW5vcmdhbml6YXRpb25pZCI6IlRCQyIsImFzc3VyYW5jZXNjb3JlIjpudWxsLCJhc3N1cmFuY2VsZXZlbCI6bnVsbH0sImlzcyI6IlBpbmdBY2Nlc3NBdXRoVG9rZW4iLCJmcCI6eyJzdWJqZWN0IjoiUGVyZlRlc3RYNTA5Q2xpZW50OjpDTj1Cb2VpbmcgQmFzaWMgQXNzdXJhbmNlIFNvZnR3YXJlIElzc3VpbmcgQ0EgRzMsT1U9Y2VydHNlcnZlcnMsTz1Cb2VpbmcsQz1VUzo6ODQ3NDI4ODk0MjA0MzcyOTI5OTk5OTM2NTYxNDg0ODM2NTUwMDgzNzE5NjM2IiwiYXV0aG5Tb3VyY2UiOiJQZXJmVGVzdFg1MDlDbGllbnQifSwiY2VydCI6eyJzdWJzaWRpYXJ5Y29tcGFueUlEIjpudWxsLCJJc3N1ZXIiOiJDTj1Cb2VpbmcgQmFzaWMgQXNzdXJhbmNlIFNvZnR3YXJlIElzc3VpbmcgQ0EgRzMsT1U9Y2VydHNlcnZlcnMsTz1Cb2VpbmcsQz1VUyIsInN1YmplY3QiOiJDTj10ZXN0Y2xpZW50Y2VydC5mZWRwLmRpZ2l0YWxhdmlhdGlvbnNlcnZpY2VzLmNvbSxPVT1zZXJ2ZXJzLE89Qm9laW5nLEM9VVMiLCJzZXJ2aWNlIjpudWxsLCJ1QXR0cmlidXRlcyI6bnVsbCwic3Vic2lkaWFyeUlEIjoiVEJDIiwiYm9laW5nQ29tcGFueUlEIjoiVEJDIiwic2VydmljZUlEIjoiUGVyZlRlc3RYNTA5Q2xpZW50Iiwic2VyaWFsTm8iOiIjODQ3NDI4ODk0MjA0MzcyOTI5OTk5OTM2NTYxNDg0ODM2NTUwMDgzNzE5NjM2In0sImV4cCI6MTYyOTIyNjU3MCwiaWF0IjoxNjI5MjI1Njc1fQ.-8Ucf8ao4Y5j7mmo-OLvVdAKwcwGEEodCpjSqdlv0t935GxNhTbMhml6v2plMRYaGyF-d-MNkXaGbLzZvuzbtg'
    And form field airportId = 'RKJJ'
    And form field startDateTime = '2022-01-21T04:31:00Z'
    And form field endDateTime = '2022-06-30T23:59:00Z'
    And form field runwayIds = '025F'
    When method GET
    Then status 200
    And match $ contains []
